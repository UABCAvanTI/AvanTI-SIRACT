<<<<<<< HEAD
=======
SEGUNDO ESCRITO FUERA DENETBEANS Y CON CAMBIOS DESDE NETBEANS
Nueva Linea desde Netbeans
COMMIT DESDE NETBEANS
>>>>>>> origin/master
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions"
                template="Template/MasterTemplate.xhtml">
    <ui:define name="contenido">

        <f:view contentType="text/html">  
            <h:head>
                <h:outputStylesheet name="Style.css" library="css" />
                <h:outputStylesheet name="Style_botones.css" library="css"/>
                <f:facet name="first">
                    <meta content='text/html; charset=UTF-8' http-equiv="Content-Type" />
                    <title>Catálogo - Contenido Temático</title>
                </f:facet>

            </h:head>
            <h:body>
               
                <center>
                    <h:form id="form" styleClass="formulario" style="width: 90%"  rendered="#{loginBean.tienePermiso}" onkeypress="if (event.keyCode == 13) { return false; }">                      
                      
                        
                        <p:growl id="growl" showDetail="true" life="10000" />
                        <p:fieldset id="field" legend="Catálogo de contenido temático" styleClass="myFieldset" style="width: 100%">
                            <p:outputPanel >
                                <div>
                                    <p:panelGrid id="grid" styleClass="mypanelgrid" columnClasses="centered">
                                       <p:row>
                                            <p:column>
                                                
                                                <span><b>Unidad de Aprendizaje: </b></span>
                                                <p:selectOneMenu id="UnidadesAprendizaje" value="#{catalogoCTBeanUI.seleccionarUA}" 
                                                                  style="width:450px"
                                                                 filter="true" filterMatchMode="contains">
                                                    <f:selectItem itemValue="0"
                                                                  itemLabel="-- Seleccione una opción -- "/> 
                                                    <f:selectItems value="#{catalogoCTBeanUI.unidadesAprendizaje}" 
                                                                   var="uap"
                                                                   itemValue="#{uap.uapclave} -- #{uap.uapnombre} -- #{uap.uapetapaFormacion}"
                                                                   itemLabel="#{uap.uapclave} -- #{uap.uapnombre}"/>
                                                    <p:ajax listener="#{catalogoCTBeanUI.cambioUA()}" event="valueChange" update="growl etapas selecPE plan areas :formDlg:tabView1:unidades, horasc,horast,horasl,horassem,arbol,:formDlg:tabView1:unidades,:formDlg:tabView1:unidades2,:formDlg:hdis,:formDlg:hdispPL,:formDlg:tabView1:paU :formDlg:tabView1:paUnid" onstart="PF('status').show()" oncomplete="PF('status').hide()"/>
                                                    <!--<p:ajax event="valueChange" update="horasc,horast,horasl,horassem,arbol" onstart="PF('status').show()" oncomplete="PF('status').hide()"/>-->
                                                </p:selectOneMenu>
                                                
                                           </p:column>
                                            
                                           
                                        </p:row>
                                        <p:row>
                                            <!--Filtro de programaEducativo-->
                                            <p:column  styleClass="esquina" style="width: 950px">
                                                <b> CAMBIO HECHO FUERA DE NETBEANS</b> 
                                                <p:selectOneMenu id ="selecPE" value="#{catalogoCTBeanUI.programaESeleccionado}" style="width: 250px; margin-top: 10px" >
                                                    <f:selectItem itemValue="0"
                                                                  itemLabel="-- Todos --"/> 
                                                    <f:selectItems value="#{catalogoCTBeanUI.programasEducativos}" var="programa"
                                                                   itemValue="#{programa.pedid}"
                                                                   itemLabel="#{programa.pednombre}"/>
                                                    <p:ajax event="valueChange" listener="#{catalogoCTBeanUI.onChangeProgramaEducativo()}" update="plan,etapas" />
                                                    <p:ajax event="valueChange" update="UnidadesAprendizaje,horasc,horast,horasl,horassem,arbol,:formDlg:tabView1:unidades,:formDlg:tabView1:unidades2" />
                                                    <!--<p:ajax event="valueChange" update="UnidadesAprendizaje,horasc,horast,horasl,horassem,arbol" />-->
                                                </p:selectOneMenu>
                                            </p:column>
                                        </p:row>
                                        <p:row>           

                                            <p:column  styleClass="esquina" style="width: 950px">
                                                <b> Plan Estudio: </b>
                                                <p:selectOneMenu id ="plan" value="#{catalogoCTBeanUI.selectedPlanestudio.pesid}"
                                                                 disabled="#{catalogoCTBeanUI.deshabilitarPlan}"  style="width: 250px; margin-top: 10px" >
                                                    <f:selectItem itemValue="0"
                                                                  itemLabel="-- Todos --"/> 
                                                    <f:selectItems value="#{catalogoCTBeanUI.planesestudio}" var="plan"
                                                                   itemValue="#{plan.pesid}"
                                                                   itemLabel="#{plan.pesvigenciaPlan}"/>
                                                    <p:ajax event="valueChange" listener="#{catalogoCTBeanUI.onChangePlanEstudio()}" update="areas,etapas" />
                                                    <p:ajax event="valueChange" update="UnidadesAprendizaje,horasc,horast,horasl,horassem,arbol,:formDlg:tabView1:unidades,:formDlg:tabView1:unidades2" />
                                                    <!--<p:ajax event="valueChange" update="UnidadesAprendizaje,horasc,horast,horasl,horassem,arbol" />-->
                                                </p:selectOneMenu>
                                            </p:column>
                                        </p:row>

                                        <p:row>
                                            <p:column >
                                                <b> Área conocimiento: </b>
                                                <p:selectOneMenu id="areas" value="#{catalogoCTBeanUI.selectedAreaconocimiento.acoid}" 
                                                                  style="width: 300px; margin-right: 30px">
                                                    <f:selectItem itemValue="0"
                                                                  itemLabel="-- Todos --"/> 
                                                    <f:selectItems value="#{catalogoCTBeanUI.areasConocimiento}" var="area"
                                                                   itemValue="#{area.acoid}"
                                                                   itemLabel="#{area.aconombre}"/>
                                                        <p:ajax event="valueChange" listener="#{catalogoCTBeanUI.onChangeAreaConocimiento()}" update="UnidadesAprendizaje" />
                                                    <p:ajax event="valueChange" update="horasc,horast,horasl,horassem,arbol,etapas,selecPE,plan, :formDlg:tabView1:unidades,:formDlg:tabView1:unidades2"/>
                                                    <!--<p:ajax event="valueChange" update="horasc,horast,horasl,horassem,arbol"/>-->
                                                </p:selectOneMenu>

                                                <span><b>Etapa: </b></span>
                                                <p:selectOneMenu id="etapas" value="#{catalogoCTBeanUI.selectedEtapa}" 
                                                                  style="width: 250px">
                                                    <f:selectItem itemValue="0" itemLabel="-- Todos -- "/>
                                                    <f:selectItem itemValue="1" itemLabel="Básica"/>
                                                    <f:selectItem itemValue="2" itemLabel="Disciplinaria"/>
                                                    <f:selectItem itemValue="3" itemLabel="Terminal"/>

                                                    <p:ajax event="valueChange" listener="#{catalogoCTBeanUI.onChangeEtapa()}" update="UnidadesAprendizaje"/>
                                                    <p:ajax event="valueChange" update="horasc,horast,horasl,horassem,arbol,:formDlg:tabView1:unidades,:formDlg:tabView1:unidades2"/>
                                                    <!--<p:ajax event="valueChange" update="horasc,horast,horasl,horassem,arbol"/>-->
                                                </p:selectOneMenu>
                                            </p:column>
                                        </p:row>
                                                                            
                                        <p:row>
                                            <p:column>
                                                <span><b style="margin: 5px;">HC: </b>
                                                    <p:outputLabel  id="horasc" value="#{catalogoCTBeanUI.hc}" style="margin-right: 30px;#{catalogoCTBeanUI.estiloHorasC}">
                                                    </p:outputLabel>
                                                    <b style="margin: 5px">HT: </b>
                                                    <p:outputLabel id="horast" value="#{catalogoCTBeanUI.ht}" style="margin-right: 30px;#{catalogoCTBeanUI.estiloHorasT}"></p:outputLabel>

                                                    <b style="margin: 5px;">HL: </b>
                                                    <p:outputLabel id="horasl" value="#{catalogoCTBeanUI.hl}" style="margin-right: 30px;#{catalogoCTBeanUI.estiloHorasL}"></p:outputLabel>

                                                    <b style="margin: 5px; ">Horas semestre: </b>
                                                    <p:outputLabel id="horassem" value="#{catalogoCTBeanUI.calculoHoras}" style="margin-right: 30px"></p:outputLabel></span>

                                                <!--<b style="margin: 5px; ">Test UA: </b>
                                                <p:outputLabel id="testua" value="{catalogoCTBeanUI.selectedUnidadaprendizaje.uapid}" style="margin-right: 30px;color: red;"></p:outputLabel>-->
                                            </p:column>                                           
                                        </p:row>
                                    </p:panelGrid>

                                    <!--****** Dialogo para "Cargando.." -->
                                    <p:dialog widgetVar="status" modal="true" draggable="false"
                                              closable="false" resizable="false" showHeader="false"
                                              style="width: 50px;height: 50px;background: none;border: none">
                                        <p:graphicImage name="imagenes/gif-load.gif" />
                                    </p:dialog>


                                    <p:commandButton id="agregaUnidades" type="button" title="Agregar" image="btnAU" iconPos="center">
                                        <p:ajax event="click" listener="#{catalogoCTBeanUI.dialogosAgregar()}"
                                                onstart="PF('status').show()" oncomplete="PF('status').hide()"/>
                                    </p:commandButton>
                                    <p:commandButton id="eliminar" title="Eliminar #{catalogoCTBeanUI.noMostrarAlgo(catalogoCTBeanUI.tipo)}" type="button" image="btnEU" iconPos="center">
                                        <p:ajax event="click" listener="#{catalogoCTBeanUI.dialogoEliminar()}" 
                                                update=":formDlg:dlgElim" onstart="PF('status').show()" oncomplete="PF('status').hide()"/>
                                    </p:commandButton>
                                    <p:commandButton id="actualizar" type="button" title="Actualiza #{catalogoCTBeanUI.noMostrarAlgo(catalogoCTBeanUI.tipo)}" image="btnMU" iconPos="center" >
                                        <p:ajax event="click" listener="#{catalogoCTBeanUI.dialogoActualizar()}"
                                                onstart="PF('status').show()" oncomplete="PF('status').hide()" update=":formDlg:dlgActualizar"/>
                                    </p:commandButton>

                                    
                                    
                                    <!-- Message para mostrar si horas han sido o no completadas-->
                                    <p:messages id="messages" showDetail="true" for="horas" />
                                    
                                    <!-- ********* Arbol ********** -->
                                    <p:treeTable value="#{catalogoCTBeanUI.getUnidades()}" var="raiz" emptyMessage="Seleccione los conceptos para dar mantenimiento a un contenido temático."
                                                 id="arbol" style="max-width: 1200px!important;" selectionMode="single" selection="#{catalogoCTBeanUI.selectedNode}">

                                        <p:ajax event="select" listener="#{catalogoCTBeanUI.tipoNodoSeleccionado()}" update=":formDlg:tabView1:unidades :formDlg:tabView1:preNumeroTema :formDlg:tabView1:preNumeroSubtema :formDlg:tabView1:unidades2 :formDlg:tabView1:temas :form:eliminar :form:actualizar"/>
                                        <p:ajax event="unselect" listener="#{catalogoCTBeanUI.limpiarSeleccionYCampos()}" update=":formDlg:tabView1:unidades :formDlg:tabView1:unidades2 :formDlg:tabView1:temas"/>
                                        <f:facet name="header" >
                                            <h:outputLabel id="numeroReporte" value="Mantenimiento"></h:outputLabel>
                                        </f:facet>

                                    <p:column style="width: 500px!important;" headerText="#{catalogoCTBeanUI.cabeceraColumna()}">
                                           <!-- <f:facet name="header">
                                                Nombre de la Unidad
                                            </f:facet>-->
                                            <!--<h:inputText style="white-space: pre-line;width: 500px;" value="#{raiz.nombre}&#10;"  />-->
                                           <h:outputText style="white-space: pre-line;width: 500px;#{catalogoCTBeanUI.horasCompletasNodo(raiz.tipo, raiz.id)}}" value="#{raiz.numero}. #{raiz.nombre}&#10;"  />
                                        </p:column>

                                        <p:column style="width:100px!important" >
                                            <f:facet name="header">
                                                Horas
                                            </f:facet>
                                            <center>
                                                <!--<h:inputText value="#{raiz.horas}" />-->
                                                <h:outputText value="#{catalogoCTBeanUI.horasAFormato(raiz.horas)}" />
                                            </center>
                                        </p:column>
                                        <p:column style="width:100px!important">
                                            <f:facet name="header">
                                                Porcentaje de horas:
                                            </f:facet>
                                            <center>
                                                <!--<h:inputText value="#{raiz.porcentajeAvance}" />-->
                                                <h:outputText value="#{catalogoCTBeanUI.dosDecimales(raiz.porcentajeAvance)}%" />
                                            </center>
                                        </p:column>

                                        <f:facet name="footer">
                                        </f:facet>
                                    </p:treeTable>
                                    <br/>
                                </div>
                            </p:outputPanel>
                        </p:fieldset>
                    </h:form>

                    <h:form id="formDlg" onkeypress="if (event.keyCode == 13) { return false; }"> 

                        <p:dialog header="Agregar Unidades" widgetVar="dlgUnidades" resizable="false" showEffect="fade" hideEffect="explode" modal="true">
                            <p:ajax event="close" update="formDlg" listener="#{catalogoCTBeanUI.limpiarCampos()}" resetValues="true"/>
                            <p:tabView id="tabView1">
                                <p:ajax event="tabChange" listener="#{catalogoCTBeanUI.onTabChange}" update=":formDlg:tabView1"/>
                                <p:tab title="Unidad">
                                    <table border="0" cellspacing="7">
                                        <tbody >
                                            <thead>
                                                <tr>
                                                    <td>Número:</td><td>
                                                        <p:inputText id="numeroU" value="#{catalogoCTBeanUI.nuevaUnidad.uninumero}" maxlength="5" size="5"   autocomplete="false">
                                                            <pe:keyFilter  mask="num" regEx="/[0-9]/"/>
                                                        </p:inputText>
                                                    </td>

                                                </tr>
                                                <tr>
                                                    <td>Nombre:</td>
                                                    <td>  
                                                        <p:inputText id="nombreU"  maxlength="120" value="#{catalogoCTBeanUI.nuevaUnidad.uninombre}"  size="60"  autocomplete="false" >
                                                            <pe:keyFilter regEx="/[A-Za-z0-9 áéóúíñÁÉÍÓÚÑ,&quot;()]/"/> 
                                                        </p:inputText>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Horas:</td>

                                                    <td><p:inputMask id="horasUni" rendered="true" value="#{catalogoCTBeanUI.buscar}" mask="99:00" size="4" autocomplete="false">

                                                            <p:ajax event="keyup" update="paU " listener="#{catalogoCTBeanUI.calculoHorasUnidad()}" process="@this"/>                                                            

                                                        </p:inputMask>
                                                    </td>

                                                </tr>
                                                <tr>
                                                    <td>Horas Disponibles:</td>
                                                    <!-- agrego sumico Inicio -->
                                                    <td>
                                                        <p:outputLabel  id="paUnid" value="#{catalogoCTBeanUI.horasAFormato(catalogoCTBeanUI.gethDispUni())}"/>  
                                                        <!-- agrego sumico Fin -->
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td>Porcentaje de horas:</td>
                                                    <td>
                                                        <p:outputLabel id="paU" value="#{catalogoCTBeanUI.dosDecimales(catalogoCTBeanUI.porcentUni)} %"/>
                                                    </td>
                                                </tr>
                                            </thead>
                                        </tbody>
                                    </table>
                                    <p:separator style="border-color: #F1A733"/>
                                    <p:commandButton value="Agregar" title="Agrega una unidad" icon="ui-icon-circle-plus" iconPos="left" action="#{catalogoCTBeanUI.agregarUnidades}"
                                                     update=":form:horasl :form:horast :form:horasc :form:growl :form:arbol,:formDlg:tabView1:unidades,:formDlg:tabView1:unidades2,:formDlg:tabView1:numeroU,:formDlg:tabView1:nombreU,:formDlg:tabView1:paU :formDlg:tabView1:horasUni :formDlg:tabView1:paUnid" onstart="PF('status').show()" 
                                                     oncomplete="PF('status').hide();" process=":formDlg:tabView1:numeroU,:formDlg:tabView1:nombreU,:formDlg:tabView1:paU,:formDlg:tabView1:horasUni,@this"/>

                                    <p:commandButton value="Cancelar" type="button" icon="ui-icon-circle-close" onclick="dlgUnidades.hide();">
                                        <p:ajax update="tabView1" listener="#{catalogoCTBeanUI.limpiarCampos()}" />
                                    </p:commandButton>
                                </p:tab>

                                <p:tab title="Tema">
                                    <table border="0" cellspacing="7">
                                        <tbody>
                                                <tr>
                                                    <td> Unidad: </td><td>
                                                        <p:selectOneMenu id="unidades" value="#{catalogoCTBeanUI.seleccionarUnidad}" style="width:280px">
                                                            <f:selectItem itemValue="0"
                                                                          itemLabel=" Seleccione una opción "/> 
                                                            <f:selectItems value="#{catalogoCTBeanUI.getUnidadesByUA()}" 
                                                                           var="unidad"
                                                                           itemValue="#{unidad.uniid}"
                                                                           itemLabel="#{unidad.uninumero}. #{unidad.uninombre} "/>
                                                            <p:ajax event="valueChange" process="@this" listener="#{catalogoCTBeanUI.horasDisTem()}" update="hdisT preNumeroTema" />
                                                        </p:selectOneMenu>
                                                    </td>
                                                </tr>
                                            <tr><td>Número:</td><td>
                                                       <p:outputLabel id="preNumeroTema">#{catalogoCTBeanUI.numeroTema}</p:outputLabel>
                                                       <p:inputText id="numeroT" value="#{catalogoCTBeanUI.nuevoTemaunidad.tunnumero}"  maxlength="5" size="5"  >                                             
                                                            <pe:keyFilter mask="num"  regEx="/[0-9]/"/>
                                                        </p:inputText>
                                                    </td>
                                                </tr>
                                                <tr><td>Nombre:</td><td>
                                                    <p:inputText id="nombreT" maxlength="120" value="#{catalogoCTBeanUI.nuevoTemaunidad.tunnombre}" size="60">
                                                        <pe:keyFilter regEx="/[A-Za-z0-9 áéóúíñÁÉÍÓÚÑ,&quot;()]/"/> 
                                                    </p:inputText>
                                                    </td>
                                                </tr>
                                                <tr><td>Horas:</td><td>
                                                    <p:inputMask id="horasT" mask="99:99" size="4" rendered="true" value="#{catalogoCTBeanUI.buscar}">

                                                        <p:ajax event="keypress"  update="paT" listener="#{catalogoCTBeanUI.valorcVonvertido(2)}" />
                                                    </p:inputMask>
                                                    </td>
                                                </tr>
                                                <tr><td>Horas Disponibles:</td><td>
                                                    <p:outputLabel id="hdisT" value="#{catalogoCTBeanUI.horasAFormato(catalogoCTBeanUI.gethDispT())}"/>
                                                    </td>
                                               </tr>
                                                <tr><td>Porcentaje de horas:</td><td>
                                                    <p:outputLabel id="paT" value="#{catalogoCTBeanUI.dosDecimales(catalogoCTBeanUI.porcentTem)} %"/>
                                                    </td>
                                                </tr>
                                                
                                        </tbody>
                                    </table>
                                    <p:separator style="border-color: #F1A733"/>
                                    <p:commandButton value="Agregar" title="Agrega un tema" icon="ui-icon-circle-plus" iconPos="left" action="#{catalogoCTBeanUI.agregarTemas}"
                                                     update=":form:horasl :form:horast :form:horasc :form:growl  :form:arbol,:formDlg:tabView1:unidades,:formDlg:tabView1:temas,:formDlg:tabView1:numeroT,:formDlg:tabView1:nombreT,:formDlg:tabView1:horasT,:formDlg:tabView1:hdisT,:formDlg:tabView1:paT,:formDlg:tabView1" onstart="PF('status').show()" 
                                                     oncomplete="PF('status').hide();" process=":formDlg:tabView1:numeroT,:formDlg:tabView1:nombreT,:formDlg:tabView1:horasT,:formDlg:tabView1:paT,@this" />
                                    <p:commandButton value="Cancelar"  type="button" icon="ui-icon-circle-close" onclick="dlgUnidades.hide();" >
                                        <p:ajax update="tabView1" listener="#{catalogoCTBeanUI.limpiarCampos()}"/>
                                    </p:commandButton>
                                </p:tab>
                                <p:tab title="Subtema">
                                    <table border="0" cellspacing="7">
                                        <tbody>
                                            <thead>
                                                <tr><td>Unidad:</td><td>
                                                        <p:selectOneMenu id="unidades2" value="#{catalogoCTBeanUI.selectedUnidad2.uniid}" style="width:280px">
                                                            <f:selectItem itemValue="0"
                                                                          itemLabel=" Seleccione una opción  "/> 
                                                            <f:selectItems value="#{catalogoCTBeanUI.getUnidadesByUA()}"
                                                                           var="unidad"
                                                                           itemValue="#{unidad.uniid}"
                                                                           itemLabel="#{unidad.uninumero}. #{unidad.uninombre} "/>
                                                            <p:ajax event="valueChange" process="@this" update=":formDlg:tabView1:temas" />
                                                        </p:selectOneMenu>
                                                    </td>
                                                </tr>
                                                <tr><td>Tema:</td><td>
                                                        <p:selectOneMenu id="temas" value="#{catalogoCTBeanUI.seleccionarTemaunidad}" style="width:280px">
                                                            <f:selectItem itemValue="0"
                                                                          itemLabel=" Seleccione una opción  "/> 
                                                            <f:selectItems value="#{catalogoCTBeanUI.getTemasByUnidad()}" 
                                                                           var="temaunidad"
                                                                           itemValue="#{temaunidad.tunid}"
                                                                           itemLabel="#{temaunidad.tunnumero}. #{temaunidad.tunnombre} "/>
                                                            <p:ajax event="valueChange" process="@this" update="hdiSU preNumeroSubtema" listener="#{catalogoCTBeanUI.horasDisSubTe()}" />

                                                        </p:selectOneMenu>
                                                    </td>
                                                </tr>
                                                <tr><td>Número:</td><td>
                                                        <p:outputLabel id="preNumeroSubtema"> #{catalogoCTBeanUI.numeroSubtema}</p:outputLabel>
                                                        <p:inputText id="numeroS" maxlength="5" size="5"  value="#{catalogoCTBeanUI.nuevoSubtemaunidad.sutnumero}">
                                                            <pe:keyFilter mask="num"  regEx="/[0-9]/"/>
                                                        </p:inputText>
                                                    </td>
                                                </tr>
                                                <tr><td>Nombre:</td><td>
                                                        <p:inputText maxlength="120" id="nombreS" value="#{catalogoCTBeanUI.nuevoSubtemaunidad.sutnombre}" size="60">
                                                            <pe:keyFilter regEx="/[A-Za-z0-9 áéóúíñÁÉÍÓÚÑ,&quot;()]/"/> 
                                                        </p:inputText>    
                                                    </td>
                                                </tr>
                                                <tr><td>Horas:</td><td>
                                                        <p:inputMask id="horasS" mask="99:99" size="4" rendered="true" value="#{catalogoCTBeanUI.buscar}">
                                                            <p:ajax event="keypress" update="paS " listener="#{catalogoCTBeanUI.valorcVonvertido(3)}" />
                                                        </p:inputMask>
                                                    </td>
                                                </tr>
                                                <tr><td>Horas Disponibles:</td><td>
                                                        <!-- agrego sumico Inicio -->
                                                        <p:outputLabel  id="hdiSU" value="#{catalogoCTBeanUI.horasAFormato(catalogoCTBeanUI.gethDispST())}"/>  
                                                        <!-- agrego sumico Fin -->
                                                    </td>
                                                </tr>
                                                <tr><td>Porcentaje de horas:</td><td>
                                                        <p:outputLabel id="paS"  value="#{catalogoCTBeanUI.dosDecimales(catalogoCTBeanUI.porcentSubTem)} %"/>                                                        
                                                    </td>    
                                                </tr>
                                            </thead>
                                        </tbody>
                                    </table>
                                    <p:separator style="background-color: #F1A733"/>
                                    <p:commandButton value="Agregar" title="Agrega un subtema" icon="ui-icon-circle-plus" iconPos="left" action="#{catalogoCTBeanUI.agregarSubtemas}"
                                                     update=":form:horasl :form:horast :form:horasc :form:growl  :form:arbol,:formDlg:tabView1:unidades2,:formDlg:tabView1:temas,:formDlg:tabView1:numeroS,:formDlg:tabView1:nombreS,:formDlg:tabView1:horasS,:formDlg:tabView1:paS,:formDlg:tabView1:hdiSU" onstart="PF('status').show()"
                                                     oncomplete="PF('status').hide();" process=":formDlg:tabView1:numeroS,:formDlg:tabView1:nombreS,:formDlg:tabView1:horasS,:formDlg:tabView1:paS,@this"/>
                                    <p:commandButton value="Cancelar" type="button" icon="ui-icon-circle-close" onclick="dlgUnidades.hide();">
                                        <p:ajax update="tabView1" listener="#{catalogoCTBeanUI.limpiarCampos()}"/>
                                    </p:commandButton>
                                </p:tab>
                            </p:tabView>
                            <!--                        <p:commandButton value="Cancelar" type="button" icon="ui-icon-circle-close" onclick="dlgUnidades.hide();"/>  -->
                        </p:dialog>

                        <p:dialog header="Agregar Prácticas Laboratorio" widgetVar="dlgPracticaslaboratorio" resizable="false" showEffect="fade" hideEffect="explode" modal="true">
                            <p:ajax event="close" update="formDlg" listener="#{catalogoCTBeanUI.limpiarCampos()}" resetValues="true"/>

                            <p:separator>
                                <p:column>
                                </p:column>
                                <p:column>
                                    <!--
                                    <p:messages id="paVPL" showDetail="false" autoUpdate="false"/>
                                    -->
                                </p:column>                            
                            </p:separator>
                            <p:panelGrid id="cap5" style="margin-top: 20px; position: relative;"> 
                                <p:row>  
                                    <!--<p:column style="font-weight: bold;">No. de Practicas </p:column>-->
                                    <p:column style="font-weight: bold;"><center>Número:</center></p:column>
                                    <p:column>
                                        <p:inputText id="numeroPL" maxlength="5" size="5"  value="#{catalogoCTBeanUI.numeroPractica}">
                                            <pe:keyFilter  mask="num"  regEx="/[0-9]/"/>
                                        </p:inputText>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column style="font-weight: bold;"><center>Nombre:</center></p:column>
                                    <p:column width="60">
                                        <p:inputText id="nombrePL" maxlength="120" value="#{catalogoCTBeanUI.nuevaPracticaL.prlnombre}" size="60">
                                            <pe:keyFilter regEx="/[A-Za-z0-9 áéóúíñÁÉÍÓÚÑ,&quot;()]/"/> 
                                        </p:inputText>                                            
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <!--se ingresan las horas en el input y se manda clacular el promerio -->
                                    <p:column style="font-weight: bold;"><center>Horas:</center></p:column>
                                    <p:column>
                                        <p:inputMask id="horasPL" mask="99:00" value="#{catalogoCTBeanUI.buscar}" size="4" >
                                            <p:ajax event="keyup" update="paPL " listener="#{catalogoCTBeanUI.valorcVonvertido(4)}" />
                                        </p:inputMask>
                                    </p:column></p:row>
                                <p:row><p:column>
                                        Horas disponibles:</p:column><p:column>
                                        <p:outputLabel id="hdispPL" value="#{catalogoCTBeanUI.horasAFormato(catalogoCTBeanUI.horasDisLab())}" style="margin-left: 115px"  />
                                    </p:column>
                                </p:row>                            
                                <p:row>
                                    <p:column style="font-weight: bold;"><center>Porcentaje de horas:</center></p:column>
                                    <p:column>
                                        <p:outputLabel id="paPL"  value="#{catalogoCTBeanUI.dosDecimales(catalogoCTBeanUI.porcentPracL)} %"/> 

                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column></p:column>
                                    <p:column>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                            <p:commandButton value="Agregar" title="Agrega una práctica" icon="ui-icon-circle-plus" iconPos="left" action="#{catalogoCTBeanUI.agregarPracticaslaboratorio}" style="margin-bottom: 10px;"
                                             update=":form:horasl :form:horast :form:horasc :form:growl  :form:arbol,:formDlg:numeroPL,:formDlg:nombrePL,:formDlg:horasPL,:formDlg:paPL,:formDlg:hdispPL" 
                                             oncomplete="PF('status').hide();" process=":formDlg:numeroPL,:formDlg:nombrePL,:formDlg:horasPL,:formDlg:paPL,@this"
                                             onstart="PF('status').show()"/>

                            <p:commandButton value="Cancelar" type="button" icon="ui-icon-circle-close" onclick="dlgPracticaslaboratorio.hide();" style="margin-top: 10px;">
                                <p:ajax update=":form:arbol,:formDlg:numeroPL,:formDlg:nombrePL,:formDlg:horasPL,:formDlg:paPL,:formDlg:hdispPL"  listener="#{catalogoCTBeanUI.limpiarCampos()}"/>
                            </p:commandButton>
                            <!--                        <p:commandButton value="Cancelar" type="button" icon="ui-icon-circle-close" onclick="dlgPracticaslaboratorio.hide();" style="margin-top: 10px;"/>  -->
                        </p:dialog>


                        <p:dialog header="Agregar Prácticas Taller" widgetVar="dlgPracticastaller" resizable="false" showEffect="fade" hideEffect="explode" modal="true">
                            <p:ajax event="close" update="formDlg" listener="#{catalogoCTBeanUI.limpiarCampos()}" resetValues="true"/>

                            <p:separator>  
                                <p:column>
                                </p:column>     
                                <!--
                                <p:column>                                    
                                    <p:messages id="paVPT" showDetail="false" autoUpdate="true"/>                                
                                </p:column>      
                                -->
                            </p:separator>
                            <p:panelGrid id="cap6" style="margin-top: 20px; position: relative ;"  > 
                                <p:row >  
                                    <!--sumico agrego  canet para mensajes inicio (y eso fue lo único que puse en el xhtml,ajax del inputText
                                                                                    ,con el evento de "keyup",para que lo valide cada vez que cambie )-->
                                    <!--                                <p:messages id="messages" showDetail="true" autoUpdate="true"/>-->
                                    <!--sumico agrego para mensajes fin-->

                                    <p:column style="font-weight: bold;" ><center>Número:</center></p:column>
                                    <p:column>
                                        <!--sumico agrego para mensajes inicio-->
                                        <p:inputText id="numeroPT"   value="#{catalogoCTBeanUI.numeroPractica}" maxlength="5" size="5"   autocomplete="false"> 
                                            <pe:keyFilter  mask="num"  regEx="/[0-9]/"/>
                                        </p:inputText>

                                        <!--sumico agrego <pe:keyFilter  mask="num"/>para mensajes fin-->
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column style="font-weight: bold;"><center>Nombre:</center></p:column>
                                    <p:column width="60">
                                        <p:inputText id="nombrePT" value="#{catalogoCTBeanUI.nuevaPracticaT.prtnombre}"   autocomplete="false" maxlength="120" size="60">
                                            <pe:keyFilter regEx="/[A-Za-z0-9 áéóúíñÁÉÍÓÚÑ,&quot;()]/"/>   
                                        </p:inputText>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <!--se ingresan las horas en el input y se manda clacular el promerio -->
                                    <p:column style="font-weight: bold;"><center>Horas:</center></p:column>
                                    <p:column>
                                        <p:inputMask  id="horasPT" mask="99:00" value ="#{catalogoCTBeanUI.buscar}"  size="4"  style="margin-right: 15px" autocomplete="false">
                                            <p:ajax event="keypress"  update="paPT " listener="#{catalogoCTBeanUI.valorcVonvertido(5)}" />
                                            <!--<p:ajax event="keyup"  update="paVPT " listener="{catalogoCTBeanUI.calculoPracticaT()}" process="@this"/>-->
                                        </p:inputMask >
                                        </p:column></p:row>
                                <p:row><p:column>
                                        Horas disponibles:</p:column><p:column>
                                        <p:outputLabel id="hdis" value="#{catalogoCTBeanUI.horasAFormato(catalogoCTBeanUI.horasDisT())}" style="margin-left: 115px" />
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <!--se muestra en el label el porcentaje calculado con la referencia update="paPT " del input-->
                                    <p:column style="font-weight: bold;"><center>Porcentaje de horas:</center></p:column>
                                    <p:column>
                                        <p:outputLabel id="paPT"  value="#{catalogoCTBeanUI.dosDecimales(catalogoCTBeanUI.porcentPracT)} %"/>                                                                         
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>
                                    </p:column>

                                    <p:column>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                            <p:commandButton value="Agregar" title="Agrega una práctica" icon="ui-icon-circle-plus" iconPos="left" action="#{catalogoCTBeanUI.agregarPracticastaller}" style="margin-bottom: 10px;"
                                             update=" :form:horasl :form:horast :form:horasc :form:growl  :form:arbol,:formDlg:numeroPT,:formDlg:nombrePT,:formDlg:horasPT,:formDlg:paPT,:formDlg:hdis" 
                                             oncomplete="PF('status').hide();" process=":formDlg:numeroPT,:formDlg:nombrePT,:formDlg:horasPT,:formDlg:paPT,@this"
                                             onstart="PF('status').show()"/>
                            <p:commandButton value="Cancelar" type="button" icon="ui-icon-circle-close" onclick="dlgPracticastaller.hide();">
                                <p:ajax  update=":form:arbol,:formDlg:numeroPT,:formDlg:nombrePT,:formDlg:horasPT,:formDlg:paPT,:formDlg:hdis"  listener="#{catalogoCTBeanUI.limpiarCampos()}"/>
                            </p:commandButton>  

                            <!--                        <p:commandButton value="Cancelar" type="button" icon="ui-icon-circle-close" onclick="dlgPracticastaller.hide();"/>  -->
                        </p:dialog>

                        <p:dialog header="Agregar Prácticas Campo" widgetVar="dlgPracticascampo" resizable="false" showEffect="fade" hideEffect="explode" modal="true">
                            <p:separator/>
                            <p:ajax event="close" update="formDlg" listener="#{catalogoCTBeanUI.limpiarCampos()}" resetValues="true"/>

                            <p:panelGrid id="cap7" style="margin-top: 20px; position: relative"> 
                                <p:row>  
                                    <!--<p:column style="font-weight: bold;">No. de Practicas </p:column>-->
                                    <p:column style="font-weight: bold;"><center>Número:</center></p:column>
                                    <p:column>
                                        <p:inputText id="numeroPC" value="#{catalogoCTBeanUI.nuevaPracticaC.prcnumero}" maxlength="5" size="5" >
                                            <pe:keyFilter  mask="num"  regEx="/[0-9]/"/>
                                        </p:inputText>                                    
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column style="font-weight: bold;"><center>Nombre:</center></p:column>
                                    <p:column>
                                        <p:inputText maxlength="120" id="nombrePC" value="#{catalogoCTBeanUI.nuevaPracticaC.prcnombre}"/>                                             
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column style="font-weight: bold;"><center>Horas:</center></p:column>
                                    <p:column>
                                        <p:inputText id="horasPC" value="#{catalogoCTBeanUI.nuevaPracticaC.prchoras}"/>                                             
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column style="font-weight: bold;"><center>Porcentaje de horas:</center></p:column>
                                    <p:column>
                                        <p:inputText id="paPC" value="#{catalogoCTBeanUI.dosDecimales(catalogoCTBeanUI.nuevaPracticaC.prcvalorPorcentaje)}%"/>                                             
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column></p:column>
                                    <p:column>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                            <p:commandButton value="Agregar" title="Agrega una práctica" icon="ui-icon-circle-plus" iconPos="left" action="#{catalogoCTBeanUI.agregarPracticascampo()}" style="margin-bottom: 10px;"
                                             update=":form:horasl :form:horast :form:horasc :form:growl  :form:arbol,:formDlg:numeroPC,:formDlg:nombrePC,:formDlg:horasPC,:formDlg:paPC" 
                                             oncomplete="PF('status').hide();" process=":formDlg:numeroPC,:formDlg:nombrePC,:formDlg:horasPC,:formDlg:paPC,@this"
                                             onstart="PF('status').show()"/>                            
                            <p:commandButton value="Cancelar" type="button" icon="ui-icon-circle-close" onclick="dlgPracticascampo.hide();">
                                <p:ajax update=":form:arbol,:formDlg:numeroPC,:formDlg:nombrePC,:formDlg:horasPC,:formDlg:paPC" listener="#{catalogoCTBeanUI.limpiarCampos()}" resetValues="true"/>
                            </p:commandButton>      
                        </p:dialog>                    
                        <p:dialog id="dlgElim" header="Eliminar #{catalogoCTBeanUI.tipo}" widgetVar="dlgEliminar" resizable="false" showEffect="fade" hideEffect="explode" modal="true">
                            <p:outputLabel>¿Seguro que quieres eliminar este #{catalogoCTBeanUI.tipo}?</p:outputLabel>
                            <p:panelGrid style="margin-top: 20px; position: relative;"> 
                                <p:row>  
                                    <p:column style="font-weight: bold;"><center>Número:</center></p:column>
                                    <p:column>
                                        <p:outputLabel id="numeroE" value="#{catalogoCTBeanUI.numero}"/>                                             
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column style="font-weight: bold"><center>Nombre:</center></p:column>
                                    <p:column style=";width:300px;">
                                        <p:outputLabel  id="nombreE" value="#{catalogoCTBeanUI.nombre}"/>                                             
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column style="font-weight: bold;"><center>Horas:</center></p:column>
                                    <p:column>
                                        <p:outputLabel id="horasE" value="#{catalogoCTBeanUI.horasAFormato(catalogoCTBeanUI.horas)}"/>                                             
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column style="font-weight: bold;"><center>Porcentaje de horas:</center></p:column>
                                    <p:column>
                                        <p:outputLabel id="paE" value="#{catalogoCTBeanUI.dosDecimales(catalogoCTBeanUI.PA)}%"/>                                             
                                    </p:column>
                                </p:row>

                            </p:panelGrid>
                            <p:commandButton value="Eliminar" title="Elimina un nodo" icon="ui-icon-circle-minus" iconPos="left" action="#{catalogoCTBeanUI.eliminarNodo}" style="margin-bottom: 10px;" 
                                             update=":form:horasl :form:horast :form:horasc :form:growl :form:arbol,:formDlg:tabView1:unidades,:formDlg:tabView1:unidades2,:formDlg:tabView1:temas,:formDlg:hdis, :formDlg:hdispA,:formDlg:paA,:formDlg:tabView1:hdisT,:formDlg:tabView1:hdiSU, :formDlg:hdis, :formDlg:tabView1:paUnid,:formDlg:hdispPL" oncomplete="dlgEliminar.hide();PF('status').hide();" process="@this" onstart="PF('status').show()"/>
                            <p:commandButton value="Cancelar" type="button"  icon="ui-icon-circle-close" onclick="dlgEliminar.hide();" style="margin-top: 10px;"/>

                        </p:dialog>

                        <p:dialog id="dlgActualizar" header="Actualizar #{catalogoCTBeanUI.tipo}" widgetVar="dlgActualizacion"  resizable="false" showEffect="fade" hideEffect="explode" modal="true">
                            <p:panelGrid id="cap4" style="margin-top: 20px; position: relative">
                                <p:row>  
                                    <p:column style="font-weight: bold;">Número: </p:column>  
                                    <p:column>
                                        <p:outputLabel id="preNumActualizar">#{catalogoCTBeanUI.numeroTema}</p:outputLabel><p:inputText id="numeroA" value="#{catalogoCTBeanUI.numero}" maxlength="5" size="5"  >
                                            <pe:keyFilter mask="num"  regEx="/[0-9]/"/>
                                        </p:inputText>
                                    </p:column>
                                </p:row>
                                <p:row>  
                                    <p:column style="font-weight: bold;">Nombre: </p:column>  
                                    <p:column width="60">
                                        <p:inputText id="nombreA" value="#{catalogoCTBeanUI.nombre}"  maxlength="120" size="60">
                                            <pe:keyFilter regEx="/[A-Za-z0-9 áéóúíñÁÉÍÓÚÑ,&quot;()]/"/> 
                                        </p:inputText>
                                    </p:column>
                                </p:row>
                                <p:row>  
                                    <p:column style="font-weight: bold;">Horas: </p:column>  
                                    <p:column>
                                        <p:inputMask id="horasA" value="#{catalogoCTBeanUI.formatoDeHora}" mask="#{catalogoCTBeanUI.mascara}" size="3" autocomplete="false">
                                            <p:ajax event="keypress"  listener="#{catalogoCTBeanUI.calculoHorasRestantes()}" process="@this"/>
                                            <p:ajax event="keypress"  listener="#{catalogoCTBeanUI.valorcVonvertido()}" update="paA" />
                                        </p:inputMask>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>Limite de horas a asignar:  </p:column>  <p:column>
                                        
                                        <p:outputLabel id="hdispA" value="#{catalogoCTBeanUI.horasAFormato(catalogoCTBeanUI.gethDispA())}" style="margin-left: 115px"  />

                                    </p:column>
                                </p:row>
                                <p:row>  
                                    <p:column style="font-weight: bold;">Porcentaje de horas: </p:column>
                                    <p:column>
                                        <p:outputLabel id="paA" value="#{catalogoCTBeanUI.dosDecimales(catalogoCTBeanUI.PA)}"/>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                            <p:commandButton value="Actualizar" title="Actualiza un nodo" icon="ui-icon-circle-check" iconPos="left" action="#{catalogoCTBeanUI.actualizarNodo}" style="margin-bottom: 10px;"
                                             update=":form:horasl :form:horast :form:horasc :form:growl  :form:arbol,:formDlg:numeroA,:formDlg:nombreA,:formDlg:horasA, :formDlg:hdispA,:formDlg:paA,:formDlg:tabView1:hdisT,:formDlg:tabView1:hdiSU, :formDlg:hdis, :formDlg:tabView1:paUnid,:formDlg:hdispPL" 
                                             oncomplete="dlgActualizacion.hide();PF('status').hide();" process=":formDlg:numeroA,:formDlg:nombreA,:formDlg:horasA,:formDlg:paA,@this"
                                             onstart="PF('status').show()"/>

                            <p:commandButton value="Cancelar" type="button" icon="ui-icon-circle-close" update=":form:arbol,:formDlg:numeroA,:formDlg:nombreA,:formDlg:horasA,:formDlg:paA,:formDlg:hdis"  
                                             process=":formDlg:numeroA,:formDlg:nombreA,:formDlg:horasA,:formDlg:paA,@this" onclick="dlgActualizacion.hide();"/>  
                        </p:dialog>
           
                    </h:form>

                    <h:form rendered="#{loginBean.formano}" onkeypress="if (event.keyCode == 13) { return false; }">
                        <center><h1>No tienes permisos para ver esto</h1></center>

                    </h:form>
                </center>
            </h:body>
        </f:view>
    </ui:define>

Lineas cambios 
